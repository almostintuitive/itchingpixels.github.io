<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Anatomy of a touch interaction: Swipe-to-peep You open up your messaging app. Question: Why can’t you just &ldquo;peep&rdquo; into the thread by swiping on a conversation cell like this?
Today’s state of interaction design seems a bit swipe-obsessive, right? But really, why do people love to cuddle their phone? Does swiping really make touch interactions seem more effortless?
Mailbox, the iOS app I’m using stopped working for a few days for me, so I went back to the Gmail app, and I was like, how can people use this?"><meta property="og:title" content="2014 - Anatomy of a touch interaction: Swipe-to-peep"><meta property="og:description" content="Anatomy of a touch interaction: Swipe-to-peep You open up your messaging app. Question: Why can’t you just &ldquo;peep&rdquo; into the thread by swiping on a conversation cell like this?
Today’s state of interaction design seems a bit swipe-obsessive, right? But really, why do people love to cuddle their phone? Does swiping really make touch interactions seem more effortless?
Mailbox, the iOS app I’m using stopped working for a few days for me, so I went back to the Gmail app, and I was like, how can people use this?"><meta property="og:type" content="article"><meta property="og:url" content="https://itchingpixels.com/docs/archived-posts/2014-09-07-anatomy-of-a-touch-interaction-swipe-to-peep/"><meta property="article:published_time" content="2014-09-07T00:00:00+00:00"><meta property="article:modified_time" content="2020-04-04T16:23:37+02:00"><title>2014 - Anatomy of a touch interaction: Swipe-to-peep | Mark Aron Szulyovszky</title><link rel=icon href=/favicon.png type=image/x-icon><link rel=stylesheet href=/book.min.63eb88daa545365405ecdbb21033286a325c60a36cfa6d22d21e7c3bc9286941.css integrity="sha256-Y+uI2qVFNlQF7NuyEDMoajJcYKNs+m0i0h58O8koaUE="><script defer src=/en.search.min.dda487f6d175a7fc94a2fe8bc26a5dfee2e81ff514896107427e188b5ff58905.js integrity="sha256-3aSH9tF1p/yUov6Lwmpd/uLoH/UUiWEHQn4Yi1/1iQU="></script></head><body><input type=checkbox class=hidden id=menu-control><main class="container flex"><aside class=book-menu><nav><h2 class=book-brand><a href=/><span>Mark Aron Szulyovszky</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><a href=/docs/technical/ class=collapsed>Technical</a></li><li><a href=/docs/archived-posts/ class=collapsed>Archived posts</a><ul><li><a href=/docs/archived-posts/2016-01-30-functional-reactive-intuition-swift/>2016 - Functional Reactive Intuition - Swift edition</a></li><li><a href=/docs/archived-posts/2016-01-09-big-s-notation/>2016 - Big S(tate) notation</a></li><li><a href=/docs/archived-posts/2016-01-08-making-mistakes/>2016 - Making mistakes</a></li><li><a href=/docs/archived-posts/2015-08-09-post-text-messaging/>2015 - Post-text messaging?</a></li><li><a href=/docs/archived-posts/2014-09-07-anatomy-of-a-touch-interaction-swipe-to-peep/ class=active>2014 - Anatomy of a touch interaction: Swipe-to-peep</a></li><li><a href=/docs/archived-posts/2014-03-24-todays-mobile-context-insensitivity/>2014 - Today’s mobile context-insensitivity</a></li><li><a href=/docs/archived-posts/2013-01-25-life-in-a-startup-incubator/>2013 - Life in a startup incubator</a></li><li><a href=/docs/archived-posts/2014-01-01-designing-your-personal-identity/>2014 - Designing your personal identity</a></li></ul></li><li><a href=/docs/quantitative-finance/the-reasons-against-discretionary-non-systematic-investing-like-stock-picking-etc/>The reasons against discretionary (non-systematic) investing (like stock picking, etc)</a></li></ul></nav><script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label>
<strong>2014 - Anatomy of a touch interaction: Swipe-to-peep</strong>
<label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div></header><article class=markdown><h1 id=anatomy-of-a-touch-interaction-swipe-to-peep>Anatomy of a touch interaction: Swipe-to-peep</h1><p>You open up your messaging app.
Question: Why can’t you just &ldquo;peep&rdquo; into the thread by swiping on a conversation cell like this?</p><p><img src=../images/swipe-to-peep/1.gif alt></p><p>Today’s state of interaction design seems a bit swipe-obsessive, right?
But really, why do people love to cuddle their phone?
Does swiping really make touch interactions seem more effortless?</p><p>Mailbox, the iOS app I’m using stopped working for a few days for me, so I went back to the Gmail app, and I was like, how can people use this? It felt like flicking through my emails took me twice as long.
Which was clearly not true. Otherwise I would have just abandoned emails. Mailbox helps with dealing with obvious spam, or emails that you expect to receive, but not the ones that require any examination - then you’re still tapping on the email, it slides to another view, then you see that ohh it’s just your aunt asking you about whether you can make it next month to a large family gathering, which you promptly delete so you can pretend that you’ve never received it.</p><p>Okay now I’m curious, let’s have a look at some chat apps.
You’ve got some arbitrary actions if you swipe on a conversation:</p><p><img src=../images/swipe-to-peep/2.png alt></p><p>Seems kind of useless, there are other ways to delete a thread if you want to.</p><p>Is this time to do a prototype?
Hell yeah!</p><p>For the ones who’re interested in the technical details, we’re creating a UITableViewCell that if you start dragging (just add a UIPanGestureRecognizer), communicates with the main ViewController through a delegate.
We&rsquo;ll trigger the final transition (full-screen content view) if the drag movement ended on the left side of the screen.</p><pre><code>if (gestureRecognizer.state == UIGestureRecognizerStateBegan) {
    [self.delegate swipeableCellDidStartSwiping:self];
} else if (gestureRecognizer.state == UIGestureRecognizerStateChanged) {
    [self.delegate swipeableCell:self didSwipeWithHorizontalPosition:touchLocation.x progress:progress];
} else if (gestureRecognizer.state == UIGestureRecognizerStateEnded) {
    if (progress &gt;= 0.7) {
        [self.delegate swipeableCellCompletedSwiping:self];
    } else {
        [self.delegate swipeableCellCancelledSwiping:self];
    }
}
</code></pre><p>Now let’s just create a a second view and move it (its left side) along the path you leave with your finger.</p><pre><code>- (void)adjustViewBasedOnSwipeProgress:(float)progress {
    self.postWebView.center = CGPointMake(self.view.center.x+(self.view.bounds.size.width*progress), self.view.center.y);
}
</code></pre><p><img src=../images/swipe-to-peep/3.gif alt></p><p>Easy.</p><p>This is not exactly how the Mailbox swipe interaction works, but if you just grab the tile from the current position, you’ll never see enough of the content to make &ldquo;peeping&rdquo; work.</p><p>Okay, I found a problem though:
If you just swipe on a TableView Cell, it just jumps back, we don&rsquo;t trigger the new screen.</p><p><img src=../images/swipe-to-peep/4.gif alt></p><p>Solution: Let&rsquo;s check the horizontal velocity (the speed) of the swipe and base the decision also on that:</p><pre><code>else if (gestureRecognizer.state == UIGestureRecognizerStateEnded) {
        if (progress &gt;= 0.7 || touchVelocity.x &lt; -300) {
            [self.delegate swipeableCellCompletedSwiping:self];
        } else {
            [self.delegate swipeableCellCancelledSwiping:self];
        }
    }
</code></pre><p>Okay, let&rsquo;s come back to this a bit later. What happens with the visual transition? It feels a clunky.
What if we move the original screen to the left at the same time?</p><p><img src=../images/swipe-to-peep/5.gif alt></p><pre><code>- (void)adjustViewBasedOnSwipeProgress:(float)progress {
    self.tableView.center = CGPointMake(self.view.center.x-(self.view.bounds.size.width*(1-progress)), self.view.center.y);
    self.postWebView.center = CGPointMake(self.view.center.x+(self.view.bounds.size.width*progress), self.view.center.y);
}
</code></pre><p>Cool, makes a bit more sense.
What if we do a bit of a “parallax” movement with the original screen? Also, fade out the original?</p><p><img src=../images/swipe-to-peep/6.gif alt></p><pre><code>- (void)adjustViewBasedOnSwipeProgress:(float)progress {
    self.tableView.alpha = progress;
    self.tableView.center = CGPointMake(self.view.center.x*progress, self.view.center.y);
    self.postWebView.center = CGPointMake(self.view.center.x+(self.view.bounds.size.width*progress), self.view.center.y);
}
</code></pre><p>Okay, fine. But, in general, scrolling on the conversation list is crap. It&rsquo;s a bit hard to illustrate with only a few;), but the &ldquo;content screen&rdquo; will suddenly start jumping in when you slightly move to the right:</p><p><img src=../images/swipe-to-peep/7.gif alt></p><p>Let’s disable the “swipability” on the cell when the vertical acceleration (scrolling on the table) is larger than the horizontal acceleration (swiping to reveal the content)</p><p><img src=../images/swipe-to-peep/8.gif alt></p><pre><code>- (BOOL)gestureRecognizerShouldBegin:(UIPanGestureRecognizer *)gestureRecognizer {
    if ([gestureRecognizer class] == [UIPanGestureRecognizer class]) {
        CGPoint velocity = [gestureRecognizer velocityInView:nil];
        if (fabsf(velocity.x) &gt; fabsf(velocity.y) ) {
            return YES;
        }
        return NO;
    }
    return YES;
}
</code></pre><p>But now, we have to disable scrolling on the main screen’s tableview, otherwise you’ll get this weird effect:</p><p><img src=../images/swipe-to-peep/9.gif alt></p><pre><code>- (void)swipeableCell:(SwipeToPeepCell *)cell didSwipeWithHorizontalPosition:(CGFloat)horizontalPosition progress:(float)progress {
    self.tableView.scrollEnabled = NO;
    [self adjustViewBasedOnSwipeProgress:(1-progress)];
}
</code></pre><p>Okay, but you can still scroll to the other direction (right), and have a view popping where your finger is. Really confusing.
Let’s not do that.</p><p><img src=../images/swipe-to-peep/10.gif alt></p><pre><code>if (velocity.x &gt; 0) {
    return NO;
}
</code></pre><p>Now that we’re here, we could try out pop by Facebook (an awesome animation framework). It’s awesome, and with <a href=https://github.com/matthewcheok/POP-MCAnimate>MCAnimate+POP</a>, the syntax is as concise as it can get. With one extra keypath addition, you can do fancy stuff!
Just type in &ldquo;.spring&rdquo; before whatever you want to animate.</p><p><img src=../images/swipe-to-peep/11.gif alt></p><pre><code>- (void)adjustViewBasedOnSwipeProgress:(float)progress {
    self.tableView.spring.alpha = progress;
    self.tableView.spring.center = CGPointMake(self.view.center.x*progress, self.view.center.y);
    self.postWebView.spring.center = CGPointMake(self.view.center.x+(self.view.bounds.size.width*progress), self.view.center.y);
}
</code></pre><p>Smooth!</p><p>The problem now is that you have no feedback on the cell what you’ve selected&mldr;
Let’s animate the background color of cell you&rsquo;re swiping on in a hacky way!</p><p><img src=../images/swipe-to-peep/12.gif alt></p><pre><code>- (void)changeBackgroundColorBasedOnProgress:(float)progress {
    self.interactiveBackground.alpha = progress;
}


- (void)didMoveToSuperview {
    self.interactiveBackground = [[UIView alloc] initWithFrame:CGRectMake(0, 0, [UIScreen mainScreen].bounds.size.width,  self.bounds.size.height)];
    self.interactiveBackground.backgroundColor = [UIColor flatGrayColor];
    self.interactiveBackground.alpha = 0;
    [self insertSubview:self.interactiveBackground atIndex:0];
}
</code></pre><p>This probably makes more sense without the other animation, that fades out the original view completely. But it&rsquo;s something!</p><p>Ready for primetime?</p><p>Probably not.</p><p>If you&rsquo;re intrigued, download the prototype from <a href=https://github.com/itchingpixels/swipe-to-peep>github</a> and try it out yourself!</p><p><em>Don’t ever use any of the hacky solutions I’ve used here in your production code, or Jonathan Ive will come around and redesign your face into an aluminium ball with a blinking light.
You need the UIViewControllerTransition API and all that fancy stuff.
It’s fine, you can do it. I know it’s confusing, but good people wrote <a href=https://github.com/stepanhruda/STPTransitions>wrappers</a> <a href=https://github.com/Raizlabs/RZTransitions>around</a> <a href=https://github.com/itsmeichigo/ICGTransitionAnimation>it</a>. Minus one horrible API you need to learn!</em></p><p>There&rsquo;s a <a href=https://github.com/itchingpixels/SwipeToPeep/tree/hackernews>branch</a> in the repository that has a working HackerNews client with the same interaction - the only problem is that downloading & rendering a web page takes around 5 seconds on your phone, so &ldquo;peeping&rdquo; is not that instant, which makes it kind of useless. Tip from <a href=https://twitter.com/spacetimetours>Peter</a>: render it on the server side!</p><p>What else would you use this for?
I have nothing in the pipeline, so please, steal if if you want. And ping me on <a href=http://twitter.com/itchingpixels>twitter</a>!</p><p>(Yeah I have no intention writing another messaging app. Please publicly execute me if I do.)</p></article><footer class=book-footer><div class="flex justify-between"><div><a class="flex align-center" href=https://github.com/itchingpixels/itchingpixels.github.io/commit/90d88c818943e8e5cda6de811d4f6401e3ca34fd title="Last modified by Mark Aron Szulyovszky | 2020 Apr 4" target=_blank rel=noopener><img src=/svg/calendar.svg class=book-icon alt=Calendar>
<span>2020 Apr 4</span></a></div></div></footer><label for=menu-control class="hidden book-menu-overlay"></label></div></main></body></html>